<?php

echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-1▼","<br>";

    $root = $_SERVER['DOCUMENT_ROOT'];
    $path = "myphp/example/inc/header.inc.php";
    include ("$root . $path");

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-2▼","<br>";

    $fp = fopen ("test.txt","w");


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-3▼","<br>";

    $fp = fopen ("test.txt","a");

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-4▼","<br>";

    

        $fp = fopen("/usr/local/apache/data/doc/customer.txt", "w");
    if ($fp === false) {
        echo "ไม่สามารถเปิดไฟล์ได้";
        exit;
}


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-5▼","<br>";

    $handle = fopen ("somefile.txt","r");
    fclose ($handle);

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-6▼","<br>";

    $path = "C:/AppServ/www/file";
    $filename = "testfwrite.txt"; 
    $file = fopen ($path . "/" . $filename, "W");
    $data = "ทกสอบการเขียนข้อมูลลงไฟล์ด้วยฟังก์ชัน fwrite()";
    if (fwrite ($file, $data)==True){
        echo "เขียนข้อมูลลงไฟล์เรียบร้อย";
    }
    fclose ($file);

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-7▼","<br>";

    $filename = "sitevisitors.txt";
    if (file_exists ($filename)){
    $count = file($filename);
    $count  [0] ++;
    $fp = fopen ($filename, "w");
    fputs ($fp, "$count[0]");
    fclose ($fp);
    echo $count[0];
    } else {
        $fh = fopen  ($filename, "W");
        if ($fh==false) die ("ไม่สามารถสร้างไฟล์ได้");
        fputs ($fh, 1);
        fclose ($fh);
        $count = file ($filename);
        echo $count[0];
    }


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-8▼","<br>";

    $file = 'people.txt';
    $current = file_get_coutents ($file);
    $current .="John Smith \n";
    file_put_contents ($file, $current);

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-9▼","<br>";

    $file = fopen ("data.txt","r");
    while (!fecf($file)){
        $char = fgetc ($file);
        echo $char . "<br>";
    }
    fclose($file);

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-10▼","<br>";

 $fp = fopen ("somefile.txt","r");
        if (!$fp){
            echo "ไม่สามารถเปิดไฟล์ somefile.txt ได้";

       }else{
           while (false !==($char = fgetc ($fp))){
                echo "char<br>";
           }
        }
    

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-11▼","<br>";

     $filename ="/usr/local/something.txt";
            $handle = fopen ($filename, "r");
            $contents = fread ($handle, filesize ($filename));


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-12▼","<br>";

    $handle = @fopen ("/tmp/inputfile.txt","r");
            if ($handle){
                   while (($buffer = fgets ($handle, 4096 ))!==false) echo $buffer;
                   if (!feof ($handle)){
                       echo "Error: unexpected fgets () fail\n";
                   }
                   fclose ($handle);
                }

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-13▼","<br>";

                        $str = <<<EOD
                        <html><body>
                        <p>Welcome! Today is the <?php echo (date ("jS")); ?> of <?= date ("F");
                        ?>.</p>
                        
                        </body></html>
                        Text outside of the HTML block.
                        EOD;
    file_put_contents("sample.php", $str);
    $handle = @fopen("sample.php", "r");
    if ($handle){
        while (!feof($handle)){
            $buffer = fgetss($handle, 4096); // แก้ไขจุดนี้
            echo $buffer;
        }
        fclose($handle);
    }
               

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-14▼","<br>";

       $file = "monkey.gif";
                   if (file_exsts ($fike)){
                      header ("Content-Description: File Transfer");

                   header ("Content-Type: application/octet-stream");
                   header ("Content-Disposition: attachment; filename=".basename($file));
                   header ("Content-Transfer-Encoding: binary");
                   header ("Expires: 0");
                   header ("Cache-Control: must-revalidate");
                   header ("Pragma: public");
                   header ("Content-Length: " . filesize ($file));
                   ob_clean (); flush ( );
                   readfile ($file); exit;

                   }

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-15▼","<br>";

     $name = "./img/ok.png";
          $fp = fopen ($name, "rb");
           header ("Content-Type:image/png");
          header("Content-Length:".filesize($name));
          fpassthru ($fp);
          exit;    

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-16▼","<br>";

    $lines = file("http://www.example.com/");
    foreach ($lines as $line_num => $line) {
        echo "Line #<b>{$line_num}</b> : " . htmlspecialchars($line) . "<br>";
    }

    $html = implode('', file("http://www.example.com/"));

    $trimmed = file("somefile.txt", FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-17▼","<br>";

    $homepage = file_get_contents ("http://www.example.com/");
        echo $homepage;


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-18▼","<br>";

     $file = file_get_contents ("./people.txt",FILE_USE_INCLUDE_PATH);

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-19▼","<br>";

    $fh = fopen ("test.html","a");
       fwrite ($fh, "<h1>Hello world!</h1>");
       fclose ($fh);
       unlink ("test.html");

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-20▼","<br>";

     $dir = "/etc/php5/";
        if(is_dir($dir)){
           if (($dh = opendir ($dh = opendir($dh)) !==false)){
               while (($file = readdir ($dh)) !== false) {
                   echo "filename: $file : filetype: " . filetype ($dir . $file) . "<br>";
               }
                closedir ($dh);


           }
            
       }

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-21▼","<br>";

    $p = "C:/windows/php.ini";
                $basel1 = basename ($p);
                $basel2 = basename ($p, ".ini");

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-22▼","<br>";

    echo realpath("/windows/system32");

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-23▼","<br>";

       $path_parts = pathinfo ("/www/htdocs/inc/lib.inc.php");
                echo $path_parts ["dirname"] . "<br>";
                echo $path_parts ["basename"] . "<br>";
                echo $path_parts ["extension"] . "<br>";
                echo $path_parts ["filename"] . "<br>";

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-24▼","<br>";

    mkdir ("/path/to/my/dir", 0700);

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-25▼","<br>";

        if(!is_dir ("examples")){
                   mkdir ("examples");

               }
               rmdir ("examples");


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-26▼","<br>";

    $fliename = "/path/to/foo.txt";
                    if (file_exists($filename)){
                        echo "ตรวจพบไฟล์เอกสาร $filename";

                     }else{
                        echo "ไม่พบไฟล์เอกสาร $filename";
                     }

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-27▼","<br>";

    $file ='example.txt';
            $newfile = 'example.txt.bak';
            if (!copy ($file, $newfile)){
                echo "ไม่สามารถคัดลอกไฟล์ $file...ได้ <br>";
            }

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-28▼","<br>";

            rename ("/tmp/tmp_file.txt","/home/user/login/docs/my_file.txt");

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-29▼","<br>";

    if (is_uploaded_file($_FILES['userfile']['tmp_name'])) {
        echo "ไฟล์ " . $_FILES['userfile']['name'] . " อัพโหลดสําเร็จแล้ว<br>";
        echo "มีรายละเอียด ดังต่อไปนี้ <br>";
        readfile($_FILES['userfile']['tmp_name']);
    } else {
        echo "การอัพโหลดไม่สําเร็จ กรุณาตรวจสอบไฟล์ใหม่ ::";
        echo "ชื่อไฟล์ คือ \"" . $_FILES['userfile']['tmp_name'] . "\".";
    }



echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-30▼","<br>";

// <form action="uploading.php" method="post" enctype="multipart/form-data">
// <br /><input type="file" name="picture" />
// </form>
// <?php
// if (isset($_FILES['picture'])) {
// move_uploaded_file($_FILES['picture']['tmp_name'], 'uploads/' . $_FILES['picture']['name']);
// }
// ?>


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-31▼","<br>";

    <form action="uploading.php" method="post" enctype="multipart/form-data">
        <br /><input type="file" name="picture[]" />
        <br /><input type="file" name="picture[]" />
        <br /><input type="file" name="picture[]" />
        <br /><input type="file" name="picture[]" />
        <input type="submit" />
    </form>
    <?php
    if (isset($_FILES['picture'])) {
        foreach ($_FILES['picture']['error'] as $index => $value) {
            if ($value == UPLOAD_ERR_OK) {
                move_uploaded_file($_FILES['picture']['tmp_name'][$index], 'uploads/' . $_FILES['picture']['name'][$index]);
            }
        }
    }
    


echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-3▼","<br>";

    $filename = 'somefile.txt';
    echo $filename . ':' . filesize($filename). 'bytes';

echo    "<br>","<br>";
//จบEx.
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br>"
,"<br>","Ex.8-3▼","<br>";

    echo filetype ("/etc/passwd");
    echo filetype ("/etc");

?>